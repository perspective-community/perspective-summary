var f=`perspective-viewer-summary {
    overflow: auto;
}
`;var h='.summary-container{display:flex;}.align-horizontal{flex-direction:row;}.align-vertical{flex-direction:column;}.summary-column{display:flex;text-align:center;align-items:center;justify-content:space-between;margin:5px;}.align-header-top .summary-column,.align-header-bottom .summary-column{flex-direction:column;}.align-header-left .summary-column,.align-header-right .summary-column{flex-direction:row;}.summary-header{display:flex;justify-content:center;align-items:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:1.3vh;}.align-header-top .summary-header,.align-header-bottom .summary-header{flex-direction:column;}.align-header-left .summary-header,.align-header-right .summary-header{transform:rotate(-180deg);-webkit-transform:rotate(-180deg);-moz-transform:rotate(-180deg);-ms-transform:rotate(-180deg);-o-transform:rotate(-180deg);writing-mode:vertical-lr;text-overflow:ellipsis;display:inline-block;font-size:0.8vh;}.align-header-left .summary-header{border-left:1px solid var(--inactive--color,#6e6e6e);}.align-header-right .summary-header{border-right:1px solid var(--inactive--color,#6e6e6e);}.align-header-left .summary-header-divider,.align-header-right .summary-header-divider{display:none;}.summary-data{display:flex;flex-direction:column;align-items:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:3vh;}.summary-header-divider::after{content:"";display:block;margin:auto;}.align-header-top .summary-header-divider::after{border-bottom:1px solid var(--inactive--color,#6e6e6e);}.align-header-left .summary-header-divider::after{border-right:1px solid var(--inactive--color,#6e6e6e);}.align-header-right .summary-header-divider::after{border-left:1px solid var(--inactive--color,#6e6e6e);}.align-header-bottom .summary-header-divider::after{border-top:1px solid var(--inactive--color,#6e6e6e);}.align-header-top .summary-header-divider,.align-header-bottom .summary-header-divider{width:100%;}.align-horizontal.align-header-top .summary-header-divider::after,.align-horizontal.align-header-bottom .summary-header-divider::after{height:1px;width:90%;}.align-vertical.align-header-top .summary-header-divider::after,.align-vertical.align-header-bottom .summary-header-divider::after{height:1px;width:50%;}.align-horizontal.align-header-left .summary-header-divider::after,.align-horizontal.align-header-right .summary-header-divider::after{height:90%;width:1px;}.align-vertical.align-header-left .summary-header-divider::after,.align-vertical.align-header-right .summary-header-divider::after{height:50%;width:1px;}';var u=".summary-container{display:flex;}.align-horizontal{flex-direction:row;}.align-vertical{flex-direction:column;}.summary-column{display:flex;text-align:center;align-items:center;justify-content:space-between;margin:5px;}.align-header-top .summary-column,.align-header-bottom .summary-column{flex-direction:column;}.align-header-left .summary-column,.align-header-right .summary-column{flex-direction:row;}.summary-header{display:flex;justify-content:center;align-items:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:1.3vh;}.align-header-top .summary-header,.align-header-bottom .summary-header{flex-direction:column;}.align-header-left .summary-header,.align-header-right .summary-header{transform:rotate(-180deg);-webkit-transform:rotate(-180deg);-moz-transform:rotate(-180deg);-ms-transform:rotate(-180deg);-o-transform:rotate(-180deg);writing-mode:vertical-lr;text-overflow:ellipsis;display:inline-block;font-size:0.8vh;}.align-header-left .summary-header{border-left:1px solid var(--inactive--color,#6e6e6e);}.align-header-right .summary-header{border-right:1px solid var(--inactive--color,#6e6e6e);}.align-header-left .summary-header-divider,.align-header-right .summary-header-divider{display:none;}.summary-data{display:flex;flex-direction:column;align-items:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:3vh;}.summary-header{display:none;}.summary-data{display:flex;flex-direction:column;align-items:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:4vh;}";var _='.summary-container{display:flex;}.align-horizontal{flex-direction:row;}.align-vertical{flex-direction:column;}.summary-column{display:flex;text-align:center;align-items:center;justify-content:space-between;margin:5px;}.align-header-top .summary-column,.align-header-bottom .summary-column{flex-direction:column;}.align-header-left .summary-column,.align-header-right .summary-column{flex-direction:row;}.summary-header{display:flex;justify-content:center;align-items:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:1.3vh;}.align-header-top .summary-header,.align-header-bottom .summary-header{flex-direction:column;}.align-header-left .summary-header,.align-header-right .summary-header{transform:rotate(-180deg);-webkit-transform:rotate(-180deg);-moz-transform:rotate(-180deg);-ms-transform:rotate(-180deg);-o-transform:rotate(-180deg);writing-mode:vertical-lr;text-overflow:ellipsis;display:inline-block;font-size:0.8vh;}.align-header-left .summary-header{border-left:1px solid var(--inactive--color,#6e6e6e);}.align-header-right .summary-header{border-right:1px solid var(--inactive--color,#6e6e6e);}.align-header-left .summary-header-divider,.align-header-right .summary-header-divider{display:none;}.summary-data{display:flex;flex-direction:column;align-items:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:3vh;}.summary-header-divider::after{content:"";display:block;margin:auto;}.align-header-top .summary-header-divider::after{border-bottom:1px solid var(--inactive--color,#6e6e6e);}.align-header-left .summary-header-divider::after{border-right:1px solid var(--inactive--color,#6e6e6e);}.align-header-right .summary-header-divider::after{border-left:1px solid var(--inactive--color,#6e6e6e);}.align-header-bottom .summary-header-divider::after{border-top:1px solid var(--inactive--color,#6e6e6e);}.align-header-top .summary-header-divider,.align-header-bottom .summary-header-divider{width:100%;}.align-horizontal.align-header-top .summary-header-divider::after,.align-horizontal.align-header-bottom .summary-header-divider::after{height:1px;width:90%;}.align-vertical.align-header-top .summary-header-divider::after,.align-vertical.align-header-bottom .summary-header-divider::after{height:1px;width:50%;}.align-horizontal.align-header-left .summary-header-divider::after,.align-horizontal.align-header-right .summary-header-divider::after{height:90%;width:1px;}.align-vertical.align-header-left .summary-header-divider::after,.align-vertical.align-header-right .summary-header-divider::after{height:50%;width:1px;}.summary-column{text-align:left;align-items:center;justify-content:unset;}.align-header-left .summary-header,.align-header-right .summary-header{transform:rotate(0deg);-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-ms-transform:rotate(0deg);-o-transform:rotate(0deg);writing-mode:unset;font-size:1vh;}.align-header-left .summary-header{margin-right:5px;padding-right:5px;border-right:4px solid var(--inactive--color,#6e6e6e);border-left:0px;}.align-header-right .summary-header{margin-left:5px;padding-left:5px;border-left:4px solid var(--inactive--color,#6e6e6e);border-right:0px;}.align-header-top .summary-header-divider::after{border-bottom:4px solid var(--inactive--color,#6e6e6e);}.align-header-left .summary-header-divider::after{border-right:4px solid var(--inactive--color,#6e6e6e);}.align-header-right .summary-header-divider::after{border-left:4px solid var(--inactive--color,#6e6e6e);}.align-header-bottom .summary-header-divider::after{border-top:4px solid var(--inactive--color,#6e6e6e);}.align-horizontal.align-header-top .summary-header-divider::after,.align-horizontal.align-header-bottom .summary-header-divider::after{height:4px;}.align-vertical.align-header-top .summary-header-divider::after,.align-vertical.align-header-bottom .summary-header-divider::after{height:4px;}.align-horizontal.align-header-left .summary-header-divider::after,.align-horizontal.align-header-right .summary-header-divider::after{width:4px;}.align-vertical.align-header-left .summary-header-divider::after,.align-vertical.align-header-right .summary-header-divider::after{width:4px;}';import p from"dayjs";var C=["horizontal","vertical"],v="horizontal",O=["top","bottom","left","right"],y={default:{horizontal:"top",vertical:"top"},minimal:{horizontal:"top",vertical:"top"},modern:{horizontal:"right",vertical:"right"}},x={default:h,minimal:u,modern:_},g=class extends HTMLElement{constructor(){super(),this._config={plugin_config:{theme:"default",align:v,align_header:void 0,format:{},header_class:"",data_class:"",header_classes:{},data_classes:{}}},this._data=null,this._schema=null,this._container=null,this._style=null,this._loaded=!1}connectedCallback(){this._loaded||(this._shadow=this.attachShadow({mode:"open"}),this._container=document.createElement("div"),this._container.classList.add("summary-container"),this._style=document.createElement("style"),this._shadow.appendChild(this._style),this._shadow.appendChild(this._container),this._global_style=document.createElement("style"),this._global_style.textContent=f,document.head.appendChild(this._global_style)),this._loaded=!0}disconnectedCallback(){}async activate(e){}get name(){return"Summary"}get select_mode(){return"select"}get min_config_columns(){return 1}async draw(e){await this.render(e)}async update(e){await this.render(e)}async render(e){let o=await this.parentElement.save();this._config={...this._config,...o,plugin_config:this._config.plugin_config},this._schema=await e.schema();let d={start_row:0,start_col:0,end_row:1,end_col:o.columns.length,id:!1};this._data=await e.to_columns(d),this.format(o.plugin_config)}async resize(){}async clear(){}save(){return{...this._config.plugin_config}}restore(e){this.format(e)}validate(e){e=e||this._config.plugin_config;let o=e.theme!==void 0&&e.theme!==this._config.plugin_config.theme;this._config.plugin_config.theme=e.theme||this._config.plugin_config.theme,Object.keys(x).indexOf(this._config.plugin_config.theme)<0&&(this._config.plugin_config.theme="default"),this._config.plugin_config.align=e.align||this._config.plugin_config.align,C.indexOf(this._config.plugin_config.align)<0&&(this._config.plugin_config.align=v),this._config.plugin_config.align_header=e.align_header||this._config.plugin_config.align_header,O.indexOf(this._config.plugin_config.align_header)<0&&(this._config.plugin_config.align_header=y[this._config.plugin_config.theme][this._config.plugin_config.align]),(this._config.plugin_config.align_header===void 0||o&&e.align_header===void 0)&&(this._config.plugin_config.align_header=y[this._config.plugin_config.theme][this._config.plugin_config.align]),this._config.plugin_config.header_class=e.header_class||this._config.plugin_config.header_class,this._config.plugin_config.data_class=e.data_class||this._config.plugin_config.data_class,this._config.plugin_config.header_classes=e.header_classes||this._config.plugin_config.header_classes,this._config.plugin_config.data_classes=e.data_classes||this._config.plugin_config.data_classes,this._config.plugin_config.format=e.format||this._config.plugin_config.format||{}}format(e){if(!this._loaded)return;this.validate(e),this._style.textContent=x[this._config.plugin_config.theme]||h;let o=this._config.columns,m=this._config.aggregates,d=this._data.__ROW_PATH__&&this._data.__ROW_PATH__.length>0,c=new Map;for(o.forEach(i=>{let t=document.createElement("div");t.classList.add("summary-column");let l=document.createElement("span");l.classList.add("summary-header");let s=document.createElement("span");s.classList.add("summary-header-divider"),this._config.plugin_config.header_class&&l.classList.add(this._config.plugin_config.header_class),this._config.plugin_config.header_classes&&this._config.plugin_config.header_classes[i]&&l.classList.add(this._config.plugin_config.header_classes[i]),l.textContent=i;let r=document.createElement("span");if(r.classList.add("summary-data"),this._config.plugin_config.data_class&&r.classList.add(this._config.plugin_config.data_class),this._config.plugin_config.data_classes&&this._config.plugin_config.data_classes[i]&&r.classList.add(this._config.plugin_config.data_classes[i]),["top","left"].indexOf(this._config.plugin_config.align_header)>=0?(t.appendChild(l),t.appendChild(s),t.appendChild(r)):(t.appendChild(r),t.appendChild(s),t.appendChild(l)),c.set(i,t),d){let a=this._data[i],w=m[i]||(Number.isNaN(a)?"count":"sum");r.title=`${w}("${i}")`;let n=this._config.plugin_config.format[i];["integer"].indexOf(this._schema[i])>=0?this._config.plugin_config.theme==="modern"?a=`${+a<0?"-":""}${new Intl.NumberFormat("en-US",{maximumFractionDigits:+(n||0),notation:"compact",compactDisplay:"short"}).format(Math.abs(+a))}`:a=Number(a).toFixed(+(n||0)):["float"].indexOf(this._schema[i])>=0?this._config.plugin_config.theme==="modern"?a=new Intl.NumberFormat("en-US",{maximumFractionDigits:+(n||1),notation:"compact",compactDisplay:"short"}).format(Number(a)):a=Number(a).toFixed(+(n||1)):["boolean"].indexOf(this._schema[i])>=0||(["datetime","date"].indexOf(this._schema[i])>=0?this._config.plugin_config.theme==="modern"?a=p(+a).format(n||"MMM D"):a=p(+a).format(n):n!==void 0&&(a=new String(a).substring(0,+n))),r.textContent=a,this._config.plugin_config.data_classes&&this._config.plugin_config.data_classes[i]&&r.classList.add(this._config.plugin_config.data_classes[i])}else r.textContent="--";this._container.classList.remove("align-horizontal"),this._container.classList.remove("align-vertical"),this._container.classList.add(`align-${this._config.plugin_config.align}`),this._container.classList.remove("align-header-top"),this._container.classList.remove("align-header-bottom"),this._container.classList.remove("align-header-left"),this._container.classList.remove("align-header-right"),this._container.classList.add(`align-header-${this._config.plugin_config.align_header}`)});this._container.lastChild;)this._container.removeChild(this._container.lastChild);c.forEach((i,t)=>{this._container.appendChild(i)})}async restyle(e){}delete(){}};customElements.define("perspective-viewer-summary",g);function N(){customElements.get("perspective-viewer").registerPlugin("perspective-viewer-summary")}customElements.whenDefined("perspective-viewer").then(N);export{g as PerspectiveViewerSummaryPluginElement};
//# sourceMappingURL=perspective-viewer-summary.js.map
